{"version":3,"sources":["js/brim.js","js/gyro.js","js/socket.js"],"names":["gajus","brim","platform","view","touched","window","navigator","standalone","os","family","parseInt","version","scream","Scream","width","portrait","landscape","Brim","viewport","on","e","viewName","document","ontouchstart","preventDefault","addEventListener","orientation","getElementsByClassName","style","display","body","innerHTML","getElementById","FULLTILT","requestAnimationFrame","client","fulltiltOrientation","motion","getDeviceMotion","then","motionData","catch","msg","console","error","log","sendOrientation","inVR","getScreenAdjustedRotationRate","obj","alpha","beta","gamma","send","JSON","stringify","innerWidth","innerHeight","userAgent","match","touches","ontouchend","Image","WebSocket","location","host","onmessage","event","undefined","data","size","context","image","canvas","getContext","onload","height","drawImage","src"],"mappings":"YAAA,IAAIA,OAAOC,KAAMC,SAAUC,KAAMC,OAAjC,KAAIC,OAAOC,UAAMC,YAAjB,QAAiCL,SAAjCM,GAAAC,QAAAC,SAAAR,SAAAM,GAAAG,QAAA,KAAA,EAAA,CAGE,GAAIC,QAASZ,MAAMa,QADjBC,OACEC,SAAS,IACXC,UAAO,MADiBf,MAA1BD,MAAAiB,MAQEC,SAAUN,SADMX,KAAlBkB,GAAA,aAAA,SAAAC,GAKEjB,KAAOiB,EAAEC,SADX,YAAKD,EAAGC,SACNC,SAASC,aAAT,SAAAH,GACIA,EAAEI,iBACJpB,QAASgB,IAGRE,SAHDC,aAAA,SAAAH,GADFhB,QAKOgB,UAIN,QAAAlB,SAAAM,GAAAC,QAAAC,SAAAR,SAAAM,GAAAG,QAAA,KAAA,GACFN,OAZDoB,iBAAA,oBAAA,WAaKpB,OAAIqB,aACTvB,KAAO,UACLmB,SAAWK,uBAAa,SAAA,GAAAC,MAAAC,QAAA,QAEtBP,SAASK,uBAAuB,SAAS,GAAGC,MAAMC,QAAU,UAE5D,GACDP,SAAAC,aAAA,SAAAH,GANHA,EAOGI,iBACHpB,QAASgB,IAEPE,SAAAQ,KAAAC,UAAAT,SAAAU,eAAA,aAAAD,UAAAT,SAAAU,eAAA,aAAAD,UAFF1B,OAAAqB,cAIAvB,KAAS,UACTmB,SAAWK,uBAAa,SAAA,GAAAC,MAAAC,QAAA,SAGvBP,SAAAQ,KAAAC,UAAAT,SAAAU,eAAA,aAAAD;YC5CH,IAAIE,UAAUC,sBAAuBC,OAAQhC,KAAMiC,oBAA/CC,OAAJ,GAAcJ,UAAAK,eAGdD,QAAOE,KAAK,SAACC,GADbJ,oBAAiBI,IACjBC,MAAO,SAAAC,GACLC,QAAAC,MAAAF,GADFC,QAESE,IAAA,wBAGR,IALDC,iBAAA,QAAAA,KAQE,GAAIV,qBAAuBW,OAAQ,CADjC,GAAAP,GAAAJ,oBAAAY,gCACEC,IACFA,GAAIC,MAAAV,EAAaU,MACjBD,EAAIE,KAAMX,EAAVW,KACAF,EAAIG,MAAQZ,EAAWY,MACvBjB,OAAIkB,KAAOC,KAAAC,UAAXN,IAGDf,sBAAAY,GAEDA,kBAEF,IAAAC,MAAA,WAGE,SAAa,YAAT5C,MAAsBE,OAAOmD,WAAanD,OAAOoD,cAAgBnD,UAAUoD,UAAUC,MAAM,aAAerD,UAAUoD,UAAUC,MAAM,gBAAkBrD,UAAUoD,UAAUC,MAAM,wBADtLC,QAAA,EAQIxD,QAAU,SAAUgB,GADpBe,QACAyB,UAIHtC,UAJDuC,WAAA,WAOElB,QAAQE,IAAIe,SADdA,QAAS,GACPjB,QAAQE,IAAI,WACZV,OAAIkB,KAAU,YACJO,QAAI,GACZjB,QAAOE,IAAK,eAFdV,OAGOkB,KAAI,gBACDO,QAAI,GACZzB,OAAOkB,KAAK,cAFPV,QAGAE,IAAI,eACFe,QAAK,IACZzB,OAAAkB,KAAY,cAFPV,QAGAE,IAAI,eAETe,QAAQ,GAGXxD;YCtDD,IAAI0D,OAAOC,UACP5B,OAAS,GAAI4B,WAAU,QAAU1D,OAAO2D,SAASC,KADrD9B,QAAI+B,UAAO,SAAXC,GACA,GAAaC,SAATD,EAAAE,KAAaC,KAAoB,CAAA,GAE/BC,GAEEC,GAJ6B,WACrC,GAAOC,GAAPnD,SAAmBU,eAAoB,QACjCuC,GAAWE,EAAXC,WAAJ,MAEMF,EAF6B,GAAAV,OAAAU,EAG7BG,OAH6B,WAK/BF,EAAO3D,MAAQ0D,EAAM1D,MALU2D,EAAAG,OAAAJ,EAAAI,OACjCL,EAAIM,UAASL,EAAS,EAAA,EAAAA,EAAe1D,MAAxB0D,EAAbI,SAEIJ,EAAAM,IAAQX,EAAIE","file":"scripts.min.js","sourcesContent":["var gajus, brim, platform, view, touched\r\n\r\nif (!window.navigator.standalone && platform.os.family === 'iOS' && parseInt(platform.os.version, 10) >= 8) {\r\n  let scream = gajus.Scream({\r\n    width: {\r\n      portrait: 320,\r\n      landscape: 640\r\n    }\r\n  })\r\n\r\n  brim = gajus.Brim({\r\n    viewport: scream\r\n  })\r\n\r\n  brim.on('viewchange', function (e) {\r\n    view = e.viewName\r\n    if (e.viewName === 'minimal') {\r\n      document.ontouchstart = function (e) {\r\n        e.preventDefault()\r\n        touched(e)\r\n      }\r\n    } else {\r\n      document.ontouchstart = function (e) {\r\n        touched(e)\r\n      }\r\n    }\r\n  })\r\n} else if (platform.os.family === 'iOS' && parseInt(platform.os.version, 10) >= 8) {\r\n  window.addEventListener('orientationchange', function () {\r\n    if (window.orientation) {\r\n      view = 'minimal'\r\n      document.getElementsByClassName('cover')[0].style.display = 'none'\r\n    } else {\r\n      document.getElementsByClassName('cover')[0].style.display = 'block'\r\n    }\r\n  }, false)\r\n  document.ontouchstart = function (e) {\r\n    e.preventDefault()\r\n    touched(e)\r\n  }\r\n  document.body.innerHTML = document.getElementById('brim-mask').innerHTML + document.getElementById('brim-main').innerHTML\r\n  if (window.orientation) {\r\n    view = 'minimal'\r\n    document.getElementsByClassName('cover')[0].style.display = 'none'\r\n  }\r\n} else {\r\n  document.body.innerHTML = document.getElementById('brim-main').innerHTML\r\n}\r\n","var FULLTILT, requestAnimationFrame, client, view, fulltiltOrientation\r\n\r\nlet motion = new FULLTILT.getDeviceMotion()\r\nmotion.then((motionData) => {\r\n  fulltiltOrientation = motionData\r\n}).catch((msg) => {\r\n  console.error(msg)\r\n  console.log('Data not available!')\r\n})\r\n\r\nvar sendOrientation = function () {\r\n  if (fulltiltOrientation && inVR()) {\r\n    let motionData = fulltiltOrientation.getScreenAdjustedRotationRate()\r\n    let obj = {}\r\n    obj.alpha = motionData.alpha\r\n    obj.beta = motionData.beta\r\n    obj.gamma = motionData.gamma\r\n    client.send(JSON.stringify(obj))\r\n  }\r\n\r\n  requestAnimationFrame(sendOrientation)\r\n}\r\nsendOrientation()\r\n\r\nvar inVR = function () {\r\n  if (view === 'minimal' && window.innerWidth > window.innerHeight && (navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/iPhone|iPad|iPod/i))) {\r\n    return true\r\n  }\r\n  return false\r\n}\r\n\r\nlet touches = 0\r\nvar touched = function (e) {\r\n  if (client) {\r\n    touches++\r\n  }\r\n}\r\n\r\ndocument.ontouchend = function () {\r\n  console.log(touches)\r\n  if (touches > 3) {\r\n    console.log('invertX')\r\n    client.send('invertX')\r\n  } else if (touches > 2) {\r\n    console.log('recalibrate')\r\n    client.send('recalibrate')\r\n  } else if (touches > 1) {\r\n    client.send('rightClick')\r\n    console.log('rightClick')\r\n  } else if (touches > 0) {\r\n    client.send('mouseClick')\r\n    console.log('mouseClick')\r\n  }\r\n  touches = 0\r\n}\r\n\r\ntouched()\r\n","var Image, WebSocket\r\nlet client = new WebSocket('ws://' + window.location.host)\r\nclient.onmessage = function onmessage (event) {\r\n  if (event.data.size === undefined) {\r\n    let canvas = document.getElementById('video')\r\n    var context = canvas.getContext('2d')\r\n    var image = new Image()\r\n    image.onload = function () {\r\n      canvas.width = image.width\r\n      canvas.height = image.height\r\n      context.drawImage(image, 0, 0, image.width, image.height)\r\n    }\r\n    image.src = event.data\r\n  }\r\n}\r\n"],"sourceRoot":"/source/"}